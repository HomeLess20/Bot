name: Deploy & Undeploy on Schedule

on:
  schedule:
    - cron: '0 1 * * *'    # 8:00 AM (‡πÑ‡∏ó‡∏¢)
    - cron: '0 18 * * *'   # 1:00 AM (‡πÑ‡∏ó‡∏¢)
  workflow_dispatch:       # ‡πÉ‡∏´‡πâ‡∏Å‡∏î‡∏£‡∏±‡∏ô‡πÄ‡∏≠‡∏á‡πÑ‡∏î‡πâ‡∏î‡πâ‡∏ß‡∏¢ (manual)

jobs:
  scheduled:
    runs-on: ubuntu-latest
    env:
      RAILWAY_TOKEN: ${{ secrets.RAILWAY_API_KEY }}  # ‡πÉ‡∏ä‡πâ secrets API KEY ‡πÅ‡∏ö‡∏ö‡πÉ‡∏´‡∏°‡πà

    steps:
      - name: Checkout code
        uses: actions/checkout@v2

      - name: Install Railway CLI
        run: npm install -g @railway/cli

      - name: Set Railway Token
        run: railway login --token $RAILWAY_TOKEN

      - name: Simulate Deploy/Undeploy
        run: |
          echo "‚è∞ Simulating current UTC hour..."
          HOUR=$(date -u +"%H")

          echo "üïê HOUR=$HOUR"

          if [ "$HOUR" = "01" ]; then
            echo "üöÄ Deploying project (8 AM TH)"
            railway up
          elif [ "$HOUR" = "18" ]; then
            echo "üõë Undeploying project (1 AM TH)"
            railway down
          else
            echo "‚ÑπÔ∏è No action needed."
          fi
